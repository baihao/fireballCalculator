# 火球直径随时间变化计算过程

## 1. 概述

根据研究文献，爆炸火球的半径随时间变化可以通过指数拖拽模型进行拟合。该模型能够准确描述火球从爆炸初始时刻到稳定状态的全过程。

## 2. 数学模型

### 2.1 基本公式

火球半径随时间变化的拟合公式为：

```
R(t) = K * (1 - B*exp(-C*t^2))
```

其中：
- `R(t)`: 时间t时刻的火球半径 (m)
- `K`: 火球最终稳定半径 (m)，根据材料类型选择Table 3中的K2参数
- `B`: 拟合系数，固定值0.41
- `C`: 拟合系数，固定值50000 (已从ms单位转换为s单位)
- `t`: 时间 (s)

**注意**: 公式中的时间单位为秒(s)，但为了便于分析，通常显示和分析使用毫秒(ms)单位。

### 2.2 火球直径计算

火球直径与半径的关系为：
```
D(t) = 2 × R(t) = 2 × K * (1 - B*exp(-C*t^2))
```

### 2.3 火球膨胀速率计算

火球膨胀速率（半径对时间的导数）为：
```
V(t) = dR/dt = K * B * C * 2t * exp(-C*t^2)
```

## 3. 不同材料的参数

### 3.1 材料参数特性 (Table 3)

| 非爆轰材料 | K1 | K2 | B | C | 拟合精度 (%) | 二次拟合精度 (%) |
|------------|----|----|---|----|-------------|----------------|
| Polyurethane | 2.87 | 2.86 | 0.41 | 50000 | 94.99 | 95.90 |
| 30%Al/Rubber | 3.03 | 3.04 | 0.41 | 50000 | 96.44 | 96.76 |
| 40%Al/Rubber | 3.13 | 3.15 | 0.41 | 50000 | 96.70 | 96.90 |
| 50%Al/Rubber | 3.07 | 3.04 | 0.41 | 50000 | 97.95 | 97.90 |
| 60%Al/Rubber | 2.92 | 2.93 | 0.41 | 50000 | 91.77 | 93.34 |

**注意**: 
- 使用K2参数作为K值
- B和C为固定参数：B=0.41, C=50000 (已从ms单位转换为s单位)
- 拟合精度表示模型与实验数据的吻合程度

## 4. 计算步骤

### 4.1 参数设置

以Polyurethane为例：
- K = 2.86 m
- B = 0.41
- C = 50000 (已转换)

### 4.2 半径计算示例

对于Polyurethane，在时间t = 0.010 s (10 ms)时：

```
R(0.010) = 2.86 * (1 - 0.41 * exp(-50000 * 0.010^2))
          = 2.86 * (1 - 0.41 * exp(-50000 * 0.0001))
          = 2.86 * (1 - 0.41 * exp(-5))
          = 2.86 * (1 - 0.41 * 0.0067)
          = 2.86 * (1 - 0.0027)
          = 2.86 * 0.9973
          = 2.852 m
```

### 4.3 直径计算

```
D(0.010) = 2 × R(0.010) = 2 × 2.852 = 5.704 m
```

### 4.4 膨胀速率计算

```
V(0.010) = 2.86 * 0.41 * 50000 * 2 * 0.010 * exp(-50000 * 0.010^2)
          = 2.86 * 0.41 * 50000 * 2 * 0.010 * exp(-5)
          = 2.86 * 0.41 * 50000 * 2 * 0.010 * 0.0067
          = 7.901 m/s
```

## 5. 计算程序实现

### 5.1 Python代码示例

```python
import numpy as np
import matplotlib.pyplot as plt

def calculate_fireball_radius(t, K, B=0.41, C=50000):
    """
    计算火球半径
    
    参数:
    t: 时间 (s)
    K: 最终稳定半径 (m)，使用Table 3中的K2参数
    B: 拟合系数，默认0.41
    C: 拟合系数，默认50000 (已从ms单位转换为s单位)
    
    返回:
    R: 火球半径 (m)
    """
    R = K * (1 - B * np.exp(-C * t**2))
    return R

def calculate_fireball_diameter(t, K, B=0.41, C=50000):
    """
    计算火球直径
    
    参数:
    t: 时间 (s)
    K: 最终稳定半径 (m)
    B: 拟合系数，默认0.41
    C: 拟合系数，默认50000
    
    返回:
    D: 火球直径 (m)
    """
    R = calculate_fireball_radius(t, K, B, C)
    D = 2 * R
    return D

def calculate_expansion_velocity(t, K, B=0.41, C=50000):
    """
    计算火球膨胀速率
    
    参数:
    t: 时间 (s)
    K: 最终稳定半径 (m)
    B: 拟合系数，默认0.41
    C: 拟合系数，默认50000
    
    返回:
    V: 火球膨胀速率 (m/s)
    """
    V = K * B * C * 2 * t * np.exp(-C * t**2)
    return V

# 材料参数 (使用K2值)
materials = {
    'Polyurethane': 2.86,
    '30%Al/Rubber': 3.04,
    '40%Al/Rubber': 3.15,
    '50%Al/Rubber': 3.04,
    '60%Al/Rubber': 2.93
}

# 时间序列 (秒)
t_s = np.linspace(0, 0.018, 1000)  # 0到18ms，1000个点

# 计算并绘制结果
plt.figure(figsize=(15, 5))

plt.subplot(1, 3, 1)
for name, K in materials.items():
    R = calculate_fireball_radius(t_s, K)
    plt.plot(t_s*1000, R, label=name, linewidth=2)  # 转换为ms显示

plt.xlabel('时间 (ms)')
plt.ylabel('火球半径 (m)')
plt.title('不同材料火球半径随时间变化')
plt.legend()
plt.grid(True)

plt.subplot(1, 3, 2)
for name, K in materials.items():
    D = calculate_fireball_diameter(t_s, K)
    plt.plot(t_s*1000, D, label=name, linewidth=2)  # 转换为ms显示

plt.xlabel('时间 (ms)')
plt.ylabel('火球直径 (m)')
plt.title('不同材料火球直径随时间变化')
plt.legend()
plt.grid(True)

plt.subplot(1, 3, 3)
for name, K in materials.items():
    V = calculate_expansion_velocity(t_s, K)
    plt.plot(t_s*1000, V, label=name, linewidth=2)  # 转换为ms显示

plt.xlabel('时间 (ms)')
plt.ylabel('膨胀速率 (m/s)')
plt.title('不同材料火球膨胀速率随时间变化')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.show()
```

## 6. 物理意义分析

### 6.1 参数含义

- **K**: 火球最终稳定半径，表示火球达到稳定状态时的最大半径
- **B**: 控制火球膨胀过程的拟合系数，影响初始膨胀速度
- **C**: 控制火球膨胀过程的时间尺度，影响达到稳定状态的速度

### 6.2 火球发展过程

1. **初始阶段 (t ≈ 0)**: 火球半径接近0，开始快速膨胀
2. **膨胀阶段**: 火球半径快速增长，膨胀速率达到最大值后开始下降
3. **稳定阶段 (t → ∞)**: 火球半径趋近于K值，膨胀速率趋近于0

### 6.3 不同材料的特点

- **40%Al/Rubber**: 最终半径最大(3.15m)，铝粉含量适中，效果最佳
- **30%Al/Rubber & 50%Al/Rubber**: 最终半径中等(3.04m)
- **60%Al/Rubber**: 最终半径较小(2.93m)，铝粉含量过高可能影响效果
- **Polyurethane**: 最终半径最小(2.86m)，膨胀相对温和

## 7. 注意事项

1. **单位统一**: 确保所有参数使用相同的单位系统（米、秒）
2. **时间范围**: 计算时间应覆盖火球发展的全过程（通常0-18ms）
3. **参数精度**: 拟合精度值表示模型与实验数据的吻合程度，越高越好
4. **物理约束**: 
   - 火球半径应为正值
   - 初始时刻(t=0)半径应为0
   - 最终时刻(t→∞)半径应趋近于K值
5. **材料选择**: 根据实际应用场景选择合适的材料参数
6. **时间单位**: 公式中使用秒(s)单位，但显示和分析通常使用毫秒(ms)单位

## 8. 参考文献

- 爆炸云膨胀半径拟合系数研究
- 不同非爆轰材料的火球特性分析
- 指数拖拽模型在火球膨胀中的应用 