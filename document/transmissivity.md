# 大气传输率计算过程

本文档说明如何根据图示公式（`transmissivity.png`）计算大气在红外/可见波段的单程传输率 τ 与距离 S 的关系，并给出默认参数与计算脚本。

## 1. 公式

总体经验式（对数以 10 为底）：
```
τ = 1.006 − 0.1171·log10(X_H2O) − 0.02368·[log10(X_H2O)]^2
    − 0.03188·log10(X_CO2) + 0.001164·[log10(X_CO2)]^2
```

其中：
```
X_CO2 = (273 / Ta) · S
X_H2O = (288.651 / Ta) · (760 / 101325) · [ (RH/100) · P_w^sat(Ta) ] · S
```
- `Ta`：环境温度（单位 K）
- `S`：距离火球中心的距离（单位 m）
- `RH`：相对湿度（%）
- `P_w^sat(Ta)`：温度 `Ta` 下的水饱和蒸气压（单位 Pa）
- `τ`：无量纲传输率（0–1）

> 注意：公式中的 `log10(·)` 为常用对数；当 `X_H2O` 或 `X_CO2` ≤ 0 时，上式无定义，计算时需保证输入为正。

## 2. 默认参数

- 环境温度：`Ta = 24 °C = 297.15 K`
- 相对湿度：`RH = 48 %`
- 饱和蒸气压：`P_w^sat(Ta) = 2987.87 Pa`
- 距离范围：`S ∈ [0.5, 150] m`（可按需调整）

## 3. 计算与绘图脚本

脚本：`source/transmissivity_calculator.py`

主要函数：
- `transmissivity(S, params)`：返回给定距离 `S`（标量或数组）的传输率 `τ`
- `plot_transmissivity(params, S_min, S_max, n_points)`：绘制 `τ(S)` 曲线

运行示例：
```bash
python source/transmissivity_calculator.py
```
示例输出（部分）：
```
Ta = 297.15 K, RH = 48.0 %, PwSat = 2987.87 Pa
S =   1.0 m -> τ = 0.86325
S =  10.0 m -> τ = 0.64340
S = 100.0 m -> τ = 0.37852
```
同时脚本将弹出 `τ` 随距离的变化曲线图。

## 4. 物理与使用说明

- `τ` 随距离增加而减小，表示大气吸收/散射效应的累积增大。
- 温度 `Ta` 使用开尔文；若输入为摄氏度，先换算 `K = °C + 273.15`。
- 饱和蒸气压 `P_w^sat(Ta)` 也可采用其他经验公式或查表值；默认值为 24 °C 时的典型近似。
- 该模型为经验式，适用于一般工程估算；若用于精确辐射传输分析，应结合更完整的带谱模型与当地实测气象数据。 