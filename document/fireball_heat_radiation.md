# 爆炸火球热辐射计算说明

本文档说明如何在爆炸过程内（0–140 ms）计算距爆心距离 `x` 处的热通量与累积热辐射量，并给出可运行的计算脚本。

## 1. 热通量模型

对距离 `x`、时刻 `t` 的热通量定义为：
```
q(x, t) = E(t) · F(x, t) · τ(x)
```
- 发射项：
  ```
  E(t) = ε · σ · T(t)^4
  ```
  - `ε`：火球表面比辐射率，默认 `ε = 0.9`
  - `σ`：斯蒂芬–玻尔兹曼常数，`σ = 5.67 × 10^-8 W/(m^2·K^4)`
  - `T(t)`：火球表面温度（K）。来自 `source/fireball_temperature_calculator.py`（默认使用“blend”平滑连接，单位 K）。

- 几何视角系数：
  ```
  F(x, t) = 1/4 · ( D(t) / x )^2
  ```
  其中 `D(t) = 2·R(t)`，`R(t)` 为火球半径，来自 `source/fireball_radius_calculator.py`（指数拖曳模型）。

- 大气传输：
  ```
  τ(x) = τ(x; Ta, RH, Pw^sat(Ta))
  ```
  由 `source/transmissivity_calculator.py` 计算，默认参数：
  - `Ta = 24 °C = 297.15 K`
  - `RH = 48 %`
  - `Pw^sat(Ta) = 2987.87 Pa`

> 注：本文将 `τ` 视为与时间无关的单程路径传输率，仅随路径长度 `x` 与气象参数变化（若需要，可扩展为 `τ(x, t)` 的时变模型）。

## 2. 累积热辐射量

在时间窗 `0–140 ms` 内的热辐射量（辐射热通量的时间积分）：
```
H(x) = ∫_0^{140ms} q(x, t) dt   [J/m^2]
```
数值实现采用梯形积分，时间步长默认 800 点（可在脚本中调整）。

## 3. 计算脚本

脚本：`source/fireball_heat_radiation_calculator.py`

主要步骤：
1. 生成时间序列 `t ∈ [0, 140] ms`
2. 由温度模型得到 `T(t)`（K）
3. 由半径模型得到 `D(t) = 2R(t)`（m）
4. 计算 `τ(x)`（默认视为仅与 `x` 有关）
5. 组合得到 `q(x,t)` 并对 `t` 积分，得到 `H(x)`

运行：
```bash
python source/fireball_heat_radiation_calculator.py
```
脚本将：
- 打印 `x ∈ [4, 6] m` 处的若干 `H(x)` 样例；
- 绘制 `H(x)` 在 4–6 m 范围内的分布曲线。

## 4. 重要说明与可调项

- 本计算为工程近似：火球温度和半径来自拟合模型，`τ` 为经验式；若用于安全评估，请结合实测气象与更完整的辐射传输模型。
- 可在脚本中修改：
  - 选用的材料（影响 `R(t)` 与 `D(t)`）；
  - 传输率参数 `Ta, RH, Pw^sat`；
  - 时间范围与时间分辨率；
  - 温度模型的连接模式（`blend`/`c1`）。 